<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æµ‹è¯• - ä¸‹å‘¨ä¸‰9ç‚¹è§£æ</title>
  <style>
    body { font-family: -apple-system, sans-serif; padding: 20px; }
    .test-case { 
      margin: 10px 0; 
      padding: 15px; 
      border: 1px solid #ddd; 
      border-radius: 8px; 
    }
    .result { 
      background: #f5f5f5; 
      padding: 10px; 
      margin-top: 10px; 
      border-radius: 4px; 
    }
    .success { color: #22c55e; }
    .error { color: #ef4444; }
    .warning { color: #f59e0b; }
  </style>
</head>
<body>
  <h1>ğŸ§ª æµ‹è¯• "ä¸‹å‘¨ä¸‰9ç‚¹" è§£æé—®é¢˜</h1>
  <p>å½“å‰æ—¶é—´ï¼š<span id="currentTime"></span></p>
  
  <div class="test-case">
    <h3>ğŸ¯ é—®é¢˜æµ‹è¯•ï¼šä¸‹å‘¨ä¸‰9ç‚¹</h3>
    <button onclick="testSpecificCase('ä¸‹å‘¨ä¸‰9ç‚¹')">æµ‹è¯• "ä¸‹å‘¨ä¸‰9ç‚¹"</button>
    <div id="result-ä¸‹å‘¨ä¸‰9ç‚¹"></div>
  </div>
  
  <div class="test-case">
    <h3>ğŸ” ç›¸å…³æµ‹è¯•æ¡ˆä¾‹</h3>
    <button onclick="testSpecificCase('ä¸‹å‘¨ä¸‰')">æµ‹è¯• "ä¸‹å‘¨ä¸‰"</button>
    <div id="result-ä¸‹å‘¨ä¸‰"></div>
    
    <button onclick="testSpecificCase('ä¸‹å‘¨ä¸‰ä¸‹åˆ2ç‚¹')">æµ‹è¯• "ä¸‹å‘¨ä¸‰ä¸‹åˆ2ç‚¹"</button>
    <div id="result-ä¸‹å‘¨ä¸‰ä¸‹åˆ2ç‚¹"></div>
    
    <button onclick="testSpecificCase('ä¸‹å‘¨ä¸‰ä¸­åˆ12ç‚¹')">æµ‹è¯• "ä¸‹å‘¨ä¸‰ä¸­åˆ12ç‚¹"</button>
    <div id="result-ä¸‹å‘¨ä¸‰ä¸­åˆ12ç‚¹"></div>
    
    <button onclick="testSpecificCase('æ˜å¤©8ç‚¹')">æµ‹è¯• "æ˜å¤©8ç‚¹"</button>
    <div id="result-æ˜å¤©8ç‚¹"></div>
    
    <button onclick="testSpecificCase('åå¤©10ç‚¹åŠ')">æµ‹è¯• "åå¤©10ç‚¹åŠ"</button>
    <div id="result-åå¤©10ç‚¹åŠ"></div>
    
    <button onclick="testSpecificCase('ä¸‹å‘¨äº”14:30')">æµ‹è¯• "ä¸‹å‘¨äº”14:30"</button>
    <div id="result-ä¸‹å‘¨äº”14:30"></div>
  </div>

  <div class="test-case">
    <h3>ğŸ”§ è¯Šæ–­ï¼šæ£€æŸ¥è¯å…¸å†…å®¹</h3>
    <button onclick="checkDictionary()">æ£€æŸ¥è¯å…¸</button>
    <div id="dictionary-check"></div>
  </div>

  <script type="module">
    import { parseNaturalLanguage, POINT_IN_TIME_DICTIONARY, TIME_PERIOD_DICTIONARY } from './src/utils/naturalLanguageTimeDictionary.ts';
    import dayjs from 'dayjs';

    // æ˜¾ç¤ºå½“å‰æ—¶é—´
    document.getElementById('currentTime').textContent = dayjs().format('YYYY-MM-DD dddd HH:mm:ss');

    // æµ‹è¯•ç‰¹å®šæ¡ˆä¾‹
    window.testSpecificCase = function(input) {
      console.log(`ğŸ§ª æµ‹è¯•è¾“å…¥: "${input}"`);
      
      try {
        const result = parseNaturalLanguage(input);
        console.log('ğŸ“Š è§£æç»“æœ:', result);
        
        let html = `<div class="result">`;
        html += `<h4>è¾“å…¥: "${input}"</h4>`;
        
        if (result.matched) {
          html += `<p class="success">âœ… åŒ¹é…æˆåŠŸ</p>`;
          
          if (result.pointInTime) {
            html += `<p><strong>ç²¾ç¡®æ—¶é—´ç‚¹:</strong><br>`;
            html += `- æ—¥æœŸ: ${result.pointInTime.date.format('YYYY-MM-DD dddd')}<br>`;
            html += `- æç¤º: ${result.pointInTime.displayHint}<br>`;
            html += `- æ¨¡ç³Šæ—¥æœŸ: ${result.pointInTime.isFuzzyDate}</p>`;
          }
          
          if (result.dateRange) {
            html += `<p><strong>æ—¥æœŸèŒƒå›´:</strong><br>`;
            html += `- å¼€å§‹: ${result.dateRange.start.format('YYYY-MM-DD dddd')}<br>`;
            html += `- ç»“æŸ: ${result.dateRange.end.format('YYYY-MM-DD dddd')}<br>`;
            html += `- æç¤º: ${result.dateRange.displayHint}</p>`;
          }
          
          if (result.timePeriod) {
            html += `<p><strong>æ—¶é—´æ®µ:</strong><br>`;
            html += `- åç§°: ${result.timePeriod.name}<br>`;
            html += `- å¼€å§‹æ—¶é—´: ${result.timePeriod.startHour}:${result.timePeriod.startMinute.toString().padStart(2,'0')}<br>`;
            html += `- ç»“æŸæ—¶é—´: ${result.timePeriod.endHour}:${result.timePeriod.endMinute.toString().padStart(2,'0')}<br>`;
            html += `- æ¨¡ç³Šæ—¶é—´: ${result.timePeriod.isFuzzyTime}<br>`;
            html += `- ç±»å‹: ${result.timePeriod.timeType || 'start'}</p>`;
          }
        } else {
          html += `<p class="error">âŒ æœªåŒ¹é…åˆ°ä»»ä½•è¯æ¡</p>`;
        }
        
        html += `</div>`;
        
        document.getElementById(`result-${input}`).innerHTML = html;
        
      } catch (error) {
        console.error('âŒ è§£æé”™è¯¯:', error);
        document.getElementById(`result-${input}`).innerHTML = `
          <div class="result">
            <p class="error">âŒ è§£æå¤±è´¥: ${error.message}</p>
          </div>
        `;
      }
    };

    // æ£€æŸ¥è¯å…¸å†…å®¹
    window.checkDictionary = function() {
      let html = `<div class="result">`;
      
      // æ£€æŸ¥ POINT_IN_TIME_DICTIONARY ä¸­æ˜¯å¦æœ‰ "ä¸‹å‘¨ä¸‰"
      const hasNextWednesday = 'ä¸‹å‘¨ä¸‰' in POINT_IN_TIME_DICTIONARY;
      html += `<p><strong>POINT_IN_TIME_DICTIONARY åŒ…å« "ä¸‹å‘¨ä¸‰":</strong> ${hasNextWednesday ? 'âœ… æ˜¯' : 'âŒ å¦'}</p>`;
      
      if (hasNextWednesday) {
        const testDate = new Date();
        const result = POINT_IN_TIME_DICTIONARY['ä¸‹å‘¨ä¸‰'](testDate);
        html += `<p><strong>"ä¸‹å‘¨ä¸‰" è§£æç»“æœ:</strong><br>`;
        html += `- æ—¥æœŸ: ${result.date.format('YYYY-MM-DD dddd')}<br>`;
        html += `- æç¤º: ${result.displayHint}</p>`;
      }
      
      // æ£€æŸ¥æ˜¯å¦æœ‰ "9ç‚¹" ç›¸å…³çš„æ—¶é—´æ®µ
      const timeKeys = Object.keys(TIME_PERIOD_DICTIONARY).filter(key => key.includes('9') || key.includes('ä¹'));
      html += `<p><strong>åŒ…å« "9" æˆ– "ä¹" çš„æ—¶é—´æ®µ:</strong><br>`;
      html += timeKeys.length > 0 ? timeKeys.join(', ') : 'æ— ';
      html += `</p>`;
      
      // æµ‹è¯•ç»„åˆè¯æ£€æµ‹
      const input = 'ä¸‹å‘¨ä¸‰9ç‚¹';
      html += `<p><strong>åˆ†æ­¥è§£æ "${input}":</strong></p>`;
      
      // 1. æ£€æŸ¥æ˜¯å¦åŒ…å« "ä¸‹å‘¨ä¸‰"
      const containsNextWed = input.includes('ä¸‹å‘¨ä¸‰');
      html += `<p>1. åŒ…å« "ä¸‹å‘¨ä¸‰": ${containsNextWed ? 'âœ… æ˜¯' : 'âŒ å¦'}</p>`;
      
      // 2. æ£€æŸ¥æ˜¯å¦åŒ…å«æ•°å­—æ—¶é—´
      const timePattern = /([0-9é›¶ä¸€äºŒä¸¤ä¸‰å››äº”å…­ä¸ƒå…«ä¹åç™¾åƒä¸‡]+)ç‚¹/;
      const timeMatch = input.match(timePattern);
      html += `<p>2. åŒ¹é…æ—¶é—´æ¨¡å¼: ${timeMatch ? `âœ… åŒ¹é…åˆ° "${timeMatch[0]}"` : 'âŒ æ— åŒ¹é…'}</p>`;
      
      if (timeMatch) {
        const hourStr = timeMatch[1];
        html += `<p>   - æå–çš„å°æ—¶å­—ç¬¦ä¸²: "${hourStr}"</p>`;
        
        // å°è¯•è§£æä¸­æ–‡æ•°å­—
        try {
          // è¿™é‡Œéœ€è¦å¯¼å…¥ parseChineseNumber å‡½æ•°
          // const hour = parseChineseNumber(hourStr);
          // html += `<p>   - è§£æçš„å°æ—¶æ•°: ${hour}</p>`;
          html += `<p>   - éœ€è¦é€šè¿‡ parseChineseNumber è§£æ</p>`;
        } catch (e) {
          html += `<p>   - è§£æå¤±è´¥: ${e.message}</p>`;
        }
      }
      
      html += `</div>`;
      document.getElementById('dictionary-check').innerHTML = html;
    };
  </script>
</body>
</html>