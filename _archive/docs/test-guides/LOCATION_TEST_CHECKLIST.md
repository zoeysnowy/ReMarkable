# LocationInput 组件测试清单

## 组件集成状态

✅ LocationInput.tsx - 已创建  
✅ LocationInput.css - 已创建  
✅ EventEditModalV2.tsx - 已集成  
✅ 环境变量配置 - 已设置  
✅ CSS 冲突 - 已解决（使用 `amap-` 前缀）

## 测试步骤

### 1. 环境配置测试

**前提条件**：
- [ ] 已创建 `.env` 文件
- [ ] 已配置 `VITE_AMAP_KEY`
- [ ] 已重启开发服务器

**验证命令**：
```powershell
# 检查 .env 文件是否存在
Test-Path .env

# 查看环境变量内容（不要提交到 Git）
Get-Content .env
```

### 2. 地址自动补全测试

**测试用例 1：基本搜索**
- [ ] 打开事件编辑弹窗（新建或编辑事件）
- [ ] 定位到"地点"输入框
- [ ] 输入 "北京" 并等待 300ms
- [ ] **预期结果**：显示地址建议下拉框
- [ ] **预期内容**：显示相关地点（如 "北京大学"、"北京站" 等）

**测试用例 2：详细搜索**
- [ ] 输入 "杭州西湖"
- [ ] **预期结果**：显示西湖相关景点和地址
- [ ] 点击其中一个建议
- [ ] **预期结果**：输入框填充完整地址（如 "浙江省杭州市 西湖"）

**测试用例 3：短输入不触发**
- [ ] 输入单个字符 "北"
- [ ] **预期结果**：不显示下拉框（需要 ≥2 个字符）

**测试用例 4：防抖机制**
- [ ] 快速连续输入 "上海东方明珠"
- [ ] **预期结果**：只在输入停止 300ms 后发起一次请求

### 3. UI 交互测试

**测试用例 5：焦点管理**
- [ ] 点击输入框外部
- [ ] **预期结果**：下拉框自动关闭
- [ ] 再次聚焦输入框（有历史建议时）
- [ ] **预期结果**：下拉框重新显示

**测试用例 6：加载指示器**
- [ ] 输入搜索关键词
- [ ] **预期结果**：在请求期间显示 ⏳ 加载图标
- [ ] 请求完成后图标消失

**测试用例 7：Go 按钮状态**
- [ ] 输入框为空时
- [ ] **预期结果**：Go 按钮不显示
- [ ] 输入任意地址后
- [ ] **预期结果**：Go 按钮显示并可点击

### 4. 地图跳转测试

**测试用例 8：桌面端跳转**
- [ ] 在桌面浏览器中测试
- [ ] 输入 "北京故宫"
- [ ] 点击 🗺️ Go 按钮
- [ ] **预期结果**：在新标签页打开高德地图网页版
- [ ] **预期内容**：地图定位到故宫

**测试用例 9：移动端跳转（可选）**
- [ ] 在移动设备或使用 Chrome DevTools 模拟移动设备
- [ ] 输入 "上海外滩"
- [ ] 点击 Go 按钮
- [ ] **预期行为**：
  - 如果已安装高德地图 APP → 唤起 APP
  - 如果未安装 → 3 秒后打开网页版

### 5. 样式测试

**测试用例 10：CSS 隔离**
- [ ] 检查 LocationInput 组件样式
- [ ] **预期**：所有类名使用 `amap-` 前缀
- [ ] 检查 EventEditModalV2 中的其他输入框
- [ ] **预期**：不受 LocationInput 样式影响

**测试用例 11：响应式布局**
- [ ] 调整浏览器窗口宽度（320px → 1920px）
- [ ] **预期结果**：输入框和下拉框正确自适应

**测试用例 12：深色模式（如果支持）**
- [ ] 切换到深色模式
- [ ] **预期结果**：组件配色协调

### 6. 错误处理测试

**测试用例 13：无效 API Key**
- [ ] 在 `.env` 中设置错误的 API Key
- [ ] 输入搜索关键词
- [ ] 打开浏览器控制台
- [ ] **预期结果**：
  - 不显示下拉建议
  - 控制台输出错误日志：`[LocationInput] Failed to fetch suggestions: ...`

**测试用例 14：网络错误**
- [ ] 断开网络连接
- [ ] 输入搜索关键词
- [ ] **预期结果**：不显示下拉建议，控制台输出错误

**测试用例 15：空结果**
- [ ] 输入不存在的地址 "XYZABC123456"
- [ ] **预期结果**：不显示下拉框（suggestions 为空数组）

### 7. 数据持久化测试

**测试用例 16：保存和加载**
- [ ] 创建新事件
- [ ] 使用 LocationInput 选择地址
- [ ] 保存事件
- [ ] 关闭弹窗
- [ ] 重新打开事件编辑
- [ ] **预期结果**：地址正确显示

**测试用例 17：编辑现有地址**
- [ ] 打开已有地址的事件
- [ ] 修改地址内容
- [ ] 保存
- [ ] **预期结果**：新地址正确保存

## 性能测试

**测试用例 18：防抖性能**
- [ ] 快速连续输入 20 个字符
- [ ] 打开 Network 面板
- [ ] **预期结果**：只发起少量请求（约 2-3 次）

**测试用例 19：大量建议渲染**
- [ ] 输入通用关键词（如 "学校"）
- [ ] **预期结果**：下拉框平滑渲染，无卡顿

## 浏览器兼容性测试

- [ ] Chrome/Edge (最新版)
- [ ] Firefox (最新版)
- [ ] Safari (最新版)
- [ ] 移动端浏览器

## 问题记录

| 日期 | 问题描述 | 严重程度 | 状态 |
|------|----------|---------|------|
|      |          |         |      |

## 已知限制

1. **API 配额**：免费版 300,000 次/天，需要监控使用量
2. **国际化**：目前仅支持国内地址，国外地址可能结果不准确
3. **移动端唤起**：iOS 需要高德地图 APP 已安装

## 后续优化建议

- [ ] 添加最近搜索历史（LocalStorage）
- [ ] 支持 Google Maps 切换（国际化）
- [ ] 添加收藏地点功能
- [ ] 集成地图预览（内嵌地图组件）
- [ ] 添加地址验证和格式化

---

**测试人员**: _______  
**测试日期**: _______  
**测试版本**: _______  
**测试结果**: ✅ 通过 / ⚠️ 部分通过 / ❌ 未通过
