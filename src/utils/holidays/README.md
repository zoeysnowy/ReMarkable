# èŠ‚æ—¥ä¸å‡æœŸè¯†åˆ«åŠŸèƒ½

> **ç‰ˆæœ¬**: v2.2  
> **æ›´æ–°æ—¶é—´**: 2025-11-11  
> **çŠ¶æ€**: âœ… è®¾è®¡å®Œæˆï¼ŒåŒ…å«è‡ªåŠ¨æ›´æ–°æœºåˆ¶

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

ä¸º ReMarkable æ—¶é—´é€‰æ‹©å™¨æ·»åŠ **èŠ‚æ—¥å’Œå›½å®šå‡æœŸæ™ºèƒ½è¯†åˆ«**åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ‰ èŠ‚æ—¥è¯†åˆ«**: æ”¯æŒä¸­å›½ä¼ ç»ŸèŠ‚æ—¥ã€å›½é™…èŠ‚æ—¥ã€ç‰¹æ®Šæ—¥æœŸ
- **ğŸ–ï¸ æ³•å®šå‡æœŸ**: å†…ç½®ä¸­å›½æ³•å®šèŠ‚å‡æ—¥å’Œè°ƒä¼‘æ—¥å†
- **ğŸŒ ç¦»çº¿å¯ç”¨**: æ— éœ€å¤–éƒ¨ APIï¼Œæ‰€æœ‰æ•°æ®æœ¬åœ°å­˜å‚¨
- **ğŸ¨ æ—¥å†å¢å¼º**: æ—¥æœŸå•å…ƒæ ¼æ˜¾ç¤ºèŠ‚æ—¥æ ‡ç­¾å’Œå‡æœŸæ ‡è®°
- **ğŸ” è‡ªç„¶è¯­è¨€**: æ”¯æŒ"æ˜¥èŠ‚"ã€"ä¸­ç§‹èŠ‚"ç­‰ç›´æ¥è¾“å…¥
- **ğŸ”„ è‡ªåŠ¨æ›´æ–°**: GitHub Actions è‡ªåŠ¨æ¨é€å‡æ—¥å®‰æ’æ›´æ–° ğŸ†•

---

## ğŸ¯ ä¸ºä»€ä¹ˆä¸éœ€è¦å¤–éƒ¨ APIï¼Ÿ

### æ–¹æ¡ˆå¯¹æ¯”

| å¯¹æ¯”é¡¹ | å¤–éƒ¨ API æ–¹æ¡ˆ | æ··åˆæ–¹æ¡ˆ âœ… |
|-------|-------------|-----------|
| **ç½‘ç»œä¾èµ–** | âŒ å¿…é¡»è”ç½‘ | âœ… ç¦»çº¿å¯ç”¨ï¼ˆå¯é€‰æ›´æ–°ï¼‰ |
| **å“åº”é€Ÿåº¦** | âŒ ç½‘ç»œå»¶è¿Ÿ | âœ… å³æ—¶å“åº” |
| **ç¨³å®šæ€§** | âŒ API å¯èƒ½ä¸‹çº¿ | âœ… å®Œå…¨å¯æ§ |
| **æˆæœ¬** | âŒ å¯èƒ½éœ€è¦ä»˜è´¹ | âœ… é›¶æˆæœ¬ |
| **æ•°æ®å‡†ç¡®æ€§** | âš ï¸ ä¾èµ–ç¬¬ä¸‰æ–¹ | âœ… è‡ªä¸»æ›´æ–° |
| **ç»´æŠ¤æˆæœ¬** | âœ… æ— éœ€ç»´æŠ¤ | âœ… GitHub Actions è‡ªåŠ¨åŒ– |
| **ç”¨æˆ·ä½“éªŒ** | âš ï¸ æ•°æ®å¯èƒ½è¿‡æœŸ | âœ… è‡ªåŠ¨æ¨é€æ›´æ–°é€šçŸ¥ |
| **å†œå†æ”¯æŒ** | âš ï¸ API æ”¯æŒåº¦ä¸ä¸€ | âœ… lunar-javascript å¼ºå¤§ |

**æ¨èæ–¹æ¡ˆ**: å†…ç½®æ•°æ® + GitHub è‡ªåŠ¨æ›´æ–°æœºåˆ¶

---

## ğŸ”„ å‡æ—¥å®‰æ’è‡ªåŠ¨æ›´æ–°æ–¹æ¡ˆ

### æ–¹æ¡ˆæ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: å›½åŠ¡é™¢å‘å¸ƒå‡æ—¥å®‰æ’ï¼ˆæ¯å¹´12æœˆï¼‰                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: å¼€å‘è€…/è‡ªåŠ¨è„šæœ¬æ›´æ–° GitHub ä»“åº“                â”‚
â”‚  - æ›´æ–° adjustedWorkdays.ts                             â”‚
â”‚  - åˆ›å»ºæ–°ç‰ˆæœ¬ tag (ä¾‹: holidays-2026)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: GitHub Actions è‡ªåŠ¨æ„å»º                         â”‚
â”‚  - ç”Ÿæˆ holidays-2026.json                              â”‚
â”‚  - å‘å¸ƒ GitHub Release                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: åº”ç”¨æ£€æŸ¥æ›´æ–°ï¼ˆå¯é€‰ï¼Œåå°æ‰§è¡Œï¼‰                  â”‚
â”‚  - å¯¹æ¯”æœ¬åœ°ç‰ˆæœ¬ vs è¿œç¨‹ç‰ˆæœ¬                              â”‚
â”‚  - å¦‚æœ‰æ–°ç‰ˆæœ¬ï¼Œæ˜¾ç¤ºé€šçŸ¥                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 5: ç”¨æˆ·ç‚¹å‡»"æ›´æ–°å‡æ—¥æ•°æ®"                         â”‚
â”‚  - ä¸‹è½½ holidays-2026.json                               â”‚
â”‚  - åˆå¹¶åˆ°æœ¬åœ° localStorage                               â”‚
â”‚  - æ˜¾ç¤ºæ›´æ–°æˆåŠŸæç¤º                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®è®¾è®¡ç‚¹

âœ… **ç”¨æˆ·æ— æ„ŸçŸ¥** - åå°æ£€æŸ¥ï¼Œæœ‰æ›´æ–°æ‰é€šçŸ¥  
âœ… **ç¦»çº¿ä¼˜å…ˆ** - å³ä½¿ä¸æ›´æ–°ä¹Ÿèƒ½ä½¿ç”¨æ—§æ•°æ®  
âœ… **å¯é€‰æ›´æ–°** - ç”¨æˆ·å†³å®šæ˜¯å¦ä¸‹è½½  
âœ… **å°æ–‡ä»¶** - JSON æ–‡ä»¶ä»… 5-10KB  
âœ… **å®‰å…¨** - ä»…ä¸‹è½½æ•°æ®ï¼Œä¸æ‰§è¡Œä»£ç 

---

## ğŸ› ï¸ æŠ€æœ¯æ–¹æ¡ˆ

### ä¾èµ–åº“

```json
{
  "dependencies": {
    "lunar-javascript": "^1.6.12"  // å†œå†è®¡ç®—ï¼ˆå¼€æºã€å…è´¹ã€ç¦»çº¿ï¼‰
  }
}
```

å®‰è£…å‘½ä»¤ï¼š
```bash
npm install lunar-javascript --save
```

### æ ¸å¿ƒæ–‡ä»¶ç»“æ„

```
src/utils/holidays/
â”œâ”€â”€ types.ts                    # ç±»å‹å®šä¹‰
â”œâ”€â”€ fixedHolidays.ts           # å›ºå®šé˜³å†èŠ‚æ—¥ï¼ˆå…ƒæ—¦ã€å›½åº†ã€åœ£è¯ç­‰ï¼‰
â”œâ”€â”€ lunarHolidays.ts           # å†œå†èŠ‚æ—¥ï¼ˆæ˜¥èŠ‚ã€ä¸­ç§‹ã€ç«¯åˆç­‰ï¼‰
â”œâ”€â”€ floatingHolidays.ts        # æµ®åŠ¨æ—¥æœŸèŠ‚æ—¥ï¼ˆæ¯äº²èŠ‚ã€çˆ¶äº²èŠ‚ï¼‰
â”œâ”€â”€ adjustedWorkdays.ts        # æ³•å®šå‡æœŸå’Œè°ƒä¼‘æ—¥å†
â””â”€â”€ index.ts                   # ç»Ÿä¸€å¯¼å‡º
```

---

## ğŸ“ æ”¯æŒçš„èŠ‚æ—¥ç±»å‹

### 1ï¸âƒ£ å›ºå®šé˜³å†èŠ‚æ—¥ï¼ˆä¸€æ¬¡é…ç½®æ°¸ä¹…æœ‰æ•ˆï¼‰

```typescript
// ç¤ºä¾‹ï¼šfixedHolidays.ts
export const FIXED_SOLAR_HOLIDAYS = {
  "01-01": { name: "å…ƒæ—¦", isHoliday: true, days: 1, emoji: "ğŸŠ" },
  "10-01": { name: "å›½åº†èŠ‚", isHoliday: true, days: 7, emoji: "ğŸ‡¨ğŸ‡³" },
  "12-25": { name: "åœ£è¯èŠ‚", isHoliday: false, emoji: "ğŸ„" },
  // ...
};
```

**æ”¯æŒèŠ‚æ—¥**ï¼š
- ä¸­å›½æ³•å®šï¼šå…ƒæ—¦ã€åŠ³åŠ¨èŠ‚ã€å›½åº†èŠ‚ã€æ¸…æ˜èŠ‚
- å›½é™…èŠ‚æ—¥ï¼šæƒ…äººèŠ‚ã€åœ£è¯èŠ‚ã€å¦‡å¥³èŠ‚ã€å„¿ç«¥èŠ‚ç­‰

### 2ï¸âƒ£ å†œå†èŠ‚æ—¥ï¼ˆlunar-javascript è‡ªåŠ¨è®¡ç®—ï¼‰

```typescript
// ç¤ºä¾‹ï¼šlunarHolidays.ts
import { Lunar } from 'lunar-javascript';

export const LUNAR_HOLIDAYS = {
  "01-01": { name: "æ˜¥èŠ‚", isHoliday: true, days: 7, emoji: "ğŸ§§" },
  "08-15": { name: "ä¸­ç§‹èŠ‚", isHoliday: true, days: 1, emoji: "ğŸ¥®" },
  "05-05": { name: "ç«¯åˆèŠ‚", isHoliday: true, days: 1, emoji: "ğŸš£" },
  // ...
};

// é˜³å† â†’ å†œå†èŠ‚æ—¥
export function getLunarHoliday(date: Date): HolidayInfo | null {
  const lunar = Lunar.fromDate(date);
  const key = `${lunar.getMonth()}-${lunar.getDay()}`;
  return LUNAR_HOLIDAYS[key] || null;
}

// èŠ‚æ—¥å â†’ é˜³å†æ—¥æœŸ
parseLunarHolidayName("æ˜¥èŠ‚", 2025) // â†’ Date(2025-02-10)
```

**æ”¯æŒèŠ‚æ—¥**ï¼š
- æ˜¥èŠ‚ã€å…ƒå®µèŠ‚ã€æ¸…æ˜èŠ‚ï¼ˆå†œå†ï¼‰
- ç«¯åˆèŠ‚ã€ä¸ƒå¤•èŠ‚ã€ä¸­ç§‹èŠ‚
- é‡é˜³èŠ‚ã€è…Šå…«èŠ‚ç­‰

### 3ï¸âƒ£ æµ®åŠ¨æ—¥æœŸèŠ‚æ—¥ï¼ˆåŠ¨æ€è®¡ç®—ï¼‰

```typescript
// ç¤ºä¾‹ï¼šfloatingHolidays.ts

// æ¯äº²èŠ‚: 5æœˆç¬¬äºŒä¸ªå‘¨æ—¥
function getMothersDay(year: number): Date {
  const may = new Date(year, 4, 1);
  const firstSunday = 7 - may.getDay();
  return new Date(year, 4, firstSunday + 7);
}

// çˆ¶äº²èŠ‚: 6æœˆç¬¬ä¸‰ä¸ªå‘¨æ—¥
function getFathersDay(year: number): Date {
  const june = new Date(year, 5, 1);
  const firstSunday = 7 - june.getDay();
  return new Date(year, 5, firstSunday + 14);
}
```

**æ”¯æŒèŠ‚æ—¥**ï¼š
- æ¯äº²èŠ‚ï¼ˆ5æœˆç¬¬äºŒä¸ªå‘¨æ—¥ï¼‰
- çˆ¶äº²èŠ‚ï¼ˆ6æœˆç¬¬ä¸‰ä¸ªå‘¨æ—¥ï¼‰
- æ„Ÿæ©èŠ‚ï¼ˆ11æœˆç¬¬å››ä¸ªå‘¨å››ï¼‰

### 4ï¸âƒ£ æ³•å®šå‡æœŸå’Œè°ƒä¼‘ï¼ˆæ¯å¹´æ›´æ–°ä¸€æ¬¡ï¼‰

```typescript
// ç¤ºä¾‹ï¼šadjustedWorkdays.ts
export const ADJUSTED_WORKDAYS_2025 = {
  // è°ƒç­å·¥ä½œæ—¥
  workdays: [
    "2025-02-04",  // æ˜¥èŠ‚è°ƒç­
    "2025-04-27",  // äº”ä¸€è°ƒç­
  ],
  
  // å‡æœŸèŒƒå›´
  holidays: [
    { start: "2025-02-07", end: "2025-02-13", name: "æ˜¥èŠ‚å‡æœŸ" },
    { start: "2025-10-01", end: "2025-10-07", name: "å›½åº†å‡æœŸ" },
  ]
};

// åˆ¤æ–­æ˜¯å¦ä¸ºå·¥ä½œæ—¥ï¼ˆè€ƒè™‘è°ƒä¼‘ï¼‰
export function isWorkday(date: Date): boolean {
  // æ£€æŸ¥è°ƒç­æ—¥ â†’ æ£€æŸ¥å‡æœŸ â†’ æ£€æŸ¥æ™®é€šå‘¨æœ«
}
```

**ç»´æŠ¤æˆæœ¬**ï¼šæ¯å¹´12æœˆæ›´æ–°ä¸€æ¬¡ï¼ˆçº¦5åˆ†é’Ÿï¼‰

---

## ğŸ¨ ä½¿ç”¨ç¤ºä¾‹

### æ—¥å†æ˜¾ç¤ºå¢å¼º

```tsx
// UnifiedDateTimePicker.tsx
import { getHoliday, getLunarHoliday, isWorkday } from '@/utils/holidays';

function renderDayCell(date: Date) {
  const solarHoliday = getHoliday(date);        // å›ºå®šèŠ‚æ—¥
  const lunarHoliday = getLunarHoliday(date);   // å†œå†èŠ‚æ—¥
  const holiday = solarHoliday || lunarHoliday;
  const workday = isWorkday(date);              // å·¥ä½œæ—¥åˆ¤æ–­
  
  return (
    <div className={`day-cell ${holiday?.isHoliday ? 'holiday' : ''}`}>
      <span className="day-number">{date.getDate()}</span>
      
      {/* èŠ‚æ—¥æ ‡ç­¾ */}
      {holiday && (
        <div className="holiday-label">
          <span className="emoji">{holiday.emoji}</span>
          <span className="name">{holiday.name}</span>
        </div>
      )}
      
      {/* ä¼‘æ¯æ—¥æ ‡è®° */}
      {!workday && <span className="rest-indicator">ä¼‘</span>}
    </div>
  );
}
```

**æ•ˆæœé¢„è§ˆ**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2025-02-10  â”‚  2025-10-01  â”‚  2025-12-25  â”‚
â”‚     10       â”‚      1       â”‚      25      â”‚
â”‚  ğŸ§§ æ˜¥èŠ‚     â”‚  ğŸ‡¨ğŸ‡³ å›½åº†èŠ‚  â”‚  ğŸ„ åœ£è¯èŠ‚   â”‚
â”‚  å‡æœŸ 7å¤©    â”‚  å‡æœŸ 7å¤©    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è‡ªç„¶è¯­è¨€è¯†åˆ«

```typescript
// dateParser.ts
import { parseLunarHolidayName, getHolidayByName } from '@/utils/holidays';

parseDateFromNaturalLanguage("æ˜¥èŠ‚")    // â†’ Date(2025-02-10)
parseDateFromNaturalLanguage("ä¸­ç§‹èŠ‚")  // â†’ Date(2025-10-06)
parseDateFromNaturalLanguage("åœ£è¯èŠ‚")  // â†’ Date(2025-12-25)
parseDateFromNaturalLanguage("å›½åº†èŠ‚")  // â†’ Date(2025-10-01)
```

### å‡æœŸæç¤º

```tsx
// PlanManager.tsx æˆ– EventEditModal.tsx
const holiday = getHoliday(eventDate);

if (holiday?.isHoliday) {
  return (
    <div className="holiday-badge">
      {holiday.emoji} {holiday.name} å‡æœŸ {holiday.days}å¤©
    </div>
  );
}
```

---

## ğŸ“¦ å®ç°æ­¥éª¤

### æ­¥éª¤ 1: å®‰è£…ä¾èµ–
```bash
npm install lunar-javascript --save
```

### æ­¥éª¤ 2: åˆ›å»ºèŠ‚æ—¥æ•°æ®æ–‡ä»¶

- [x] `src/utils/holidays/types.ts` - ç±»å‹å®šä¹‰
- [x] `src/utils/holidays/fixedHolidays.ts` - å›ºå®šèŠ‚æ—¥æ•°æ®
- [ ] `src/utils/holidays/lunarHolidays.ts` - å†œå†èŠ‚æ—¥
- [ ] `src/utils/holidays/floatingHolidays.ts` - æµ®åŠ¨èŠ‚æ—¥
- [ ] `src/utils/holidays/adjustedWorkdays.ts` - è°ƒä¼‘æ—¥å†
- [ ] `src/utils/holidays/index.ts` - ç»Ÿä¸€å¯¼å‡º

### æ­¥éª¤ 3: æ‰©å±• dateParser

- [ ] å¯¼å…¥èŠ‚æ—¥å·¥å…·å‡½æ•°
- [ ] æ·»åŠ èŠ‚æ—¥è¯†åˆ«é€»è¾‘
- [ ] æ”¯æŒèŠ‚æ—¥åç§°è¾“å…¥

### æ­¥éª¤ 4: æ—¥å†æ˜¾ç¤ºå¢å¼º

- [ ] ä¿®æ”¹ `UnifiedDateTimePicker.tsx` çš„ `renderDayCell`
- [ ] æ·»åŠ èŠ‚æ—¥æ ‡ç­¾å’Œå‡æœŸæ ·å¼
- [ ] æ·»åŠ "ä¼‘"æ ‡è®°

### æ­¥éª¤ 5: CSS æ ·å¼

- [ ] æ·»åŠ  `.day-cell.holiday` æ ·å¼
- [ ] æ·»åŠ  `.holiday-label` æ ·å¼
- [ ] æ·»åŠ  `.rest-indicator` æ ·å¼

---

## ğŸ”§ å‡æ—¥æ•°æ®æ›´æ–°æœºåˆ¶

### æ–¹æ¡ˆ A: GitHub è‡ªåŠ¨æ›´æ–°ï¼ˆæ¨èï¼‰âœ…

#### æ¶æ„è®¾è®¡

```
ç”¨æˆ·è®¾å¤‡ï¼ˆElectron Appï¼‰
    â”‚
    â”œâ”€ å†…ç½®æ•°æ®: holidays-2025.json (åˆå§‹ç‰ˆæœ¬)
    â”‚
    â”œâ”€ æœ¬åœ°å­˜å‚¨: localStorage['holidayUpdates']
    â”‚   â””â”€ { "2026": {...}, "2027": {...} }
    â”‚
    â””â”€ æ›´æ–°æ£€æŸ¥å™¨
        â”‚
        â”œâ”€ æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡è¿œç¨‹ç‰ˆæœ¬
        â”‚   â””â”€ https://github.com/user/ReMarkable/releases/latest
        â”‚
        â””â”€ å‘ç°æ–°ç‰ˆæœ¬ â†’ æ˜¾ç¤ºé€šçŸ¥
            â”‚
            â””â”€ ç”¨æˆ·ç‚¹å‡» â†’ ä¸‹è½½å¹¶åˆå¹¶
```

#### å®ç°æ­¥éª¤

##### 1ï¸âƒ£ åˆ›å»ºå‡æ—¥æ•°æ® JSON æ ¼å¼

```typescript
// public/holidays/holidays-2026.json
{
  "version": "2026",
  "publishDate": "2025-12-15",
  "source": "å›½åŠ¡é™¢åŠå…¬å…",
  "sourceUrl": "http://www.gov.cn/zhengce/...",
  "data": {
    "workdays": [
      "2026-01-31",  // æ˜¥èŠ‚è°ƒç­
      "2026-02-08",
      "2026-04-26",  // äº”ä¸€è°ƒç­
      "2026-10-10"   // å›½åº†è°ƒç­
    ],
    "holidays": [
      {
        "start": "2026-01-01",
        "end": "2026-01-03",
        "name": "å…ƒæ—¦å‡æœŸ",
        "days": 3
      },
      {
        "start": "2026-02-01",
        "end": "2026-02-07",
        "name": "æ˜¥èŠ‚å‡æœŸ",
        "days": 7
      },
      {
        "start": "2026-04-04",
        "end": "2026-04-06",
        "name": "æ¸…æ˜å‡æœŸ",
        "days": 3
      },
      {
        "start": "2026-05-01",
        "end": "2026-05-05",
        "name": "åŠ³åŠ¨èŠ‚å‡æœŸ",
        "days": 5
      },
      {
        "start": "2026-06-25",
        "end": "2026-06-27",
        "name": "ç«¯åˆå‡æœŸ",
        "days": 3
      },
      {
        "start": "2026-10-01",
        "end": "2026-10-08",
        "name": "å›½åº†ä¸­ç§‹å‡æœŸ",
        "days": 8
      }
    ]
  }
}
```

##### 2ï¸âƒ£ åˆ›å»ºç‰ˆæœ¬ç®¡ç†å™¨

```typescript
// src/utils/holidays/updateManager.ts

interface HolidayVersion {
  version: string;
  publishDate: string;
  source: string;
  sourceUrl: string;
  data: AdjustedWorkday;
}

class HolidayUpdateManager {
  private static GITHUB_RELEASE_URL = 
    'https://api.github.com/repos/zoeysnowy/ReMarkable/releases/latest';
  
  private static LOCAL_STORAGE_KEY = 'holidayUpdates';
  
  /**
   * æ£€æŸ¥æ˜¯å¦æœ‰æ–°ç‰ˆæœ¬
   * @returns æ–°ç‰ˆæœ¬ä¿¡æ¯æˆ– null
   */
  async checkForUpdates(): Promise<HolidayVersion | null> {
    try {
      // 1. è·å–è¿œç¨‹ç‰ˆæœ¬ä¿¡æ¯
      const response = await fetch(this.GITHUB_RELEASE_URL);
      const release = await response.json();
      
      // 2. æŸ¥æ‰¾å‡æ—¥æ•°æ®èµ„äº§
      const asset = release.assets.find((a: any) => 
        a.name.startsWith('holidays-') && a.name.endsWith('.json')
      );
      
      if (!asset) return null;
      
      // 3. æå–ç‰ˆæœ¬å·ï¼ˆä¾‹: holidays-2026.json â†’ 2026ï¼‰
      const remoteVersion = asset.name.match(/holidays-(\d{4})\.json/)?.[1];
      if (!remoteVersion) return null;
      
      // 4. å¯¹æ¯”æœ¬åœ°ç‰ˆæœ¬
      const localData = this.getLocalData();
      if (localData[remoteVersion]) {
        console.log(`å·²æœ‰ ${remoteVersion} å¹´å‡æ—¥æ•°æ®`);
        return null;
      }
      
      // 5. ä¸‹è½½æ–°ç‰ˆæœ¬æ•°æ®
      const dataResponse = await fetch(asset.browser_download_url);
      const newData: HolidayVersion = await dataResponse.json();
      
      return newData;
    } catch (error) {
      console.error('æ£€æŸ¥æ›´æ–°å¤±è´¥:', error);
      return null;
    }
  }
  
  /**
   * å®‰è£…æ›´æ–°
   * @param versionData æ–°ç‰ˆæœ¬æ•°æ®
   */
  installUpdate(versionData: HolidayVersion): void {
    const localData = this.getLocalData();
    localData[versionData.version] = versionData.data;
    
    localStorage.setItem(
      HolidayUpdateManager.LOCAL_STORAGE_KEY, 
      JSON.stringify(localData)
    );
    
    console.log(`âœ… ${versionData.version} å¹´å‡æ—¥æ•°æ®å·²æ›´æ–°`);
  }
  
  /**
   * è·å–æœ¬åœ°æ•°æ®
   */
  private getLocalData(): Record<string, AdjustedWorkday> {
    const stored = localStorage.getItem(HolidayUpdateManager.LOCAL_STORAGE_KEY);
    return stored ? JSON.parse(stored) : {};
  }
  
  /**
   * è·å–æŒ‡å®šå¹´ä»½çš„å‡æ—¥æ•°æ®
   */
  getHolidayData(year: number): AdjustedWorkday | null {
    const localData = this.getLocalData();
    
    // 1. ä¼˜å…ˆä» localStorage è·å–ï¼ˆç”¨æˆ·å·²æ›´æ–°ï¼‰
    if (localData[year]) {
      return localData[year];
    }
    
    // 2. å›é€€åˆ°å†…ç½®æ•°æ®
    if (year === 2025) return ADJUSTED_WORKDAYS_2025;
    if (year === 2026) return ADJUSTED_WORKDAYS_2026; // å¦‚æœæœ‰å†…ç½®
    
    return null;
  }
}

export const holidayUpdateManager = new HolidayUpdateManager();
```

##### 3ï¸âƒ£ å®šæ—¶æ£€æŸ¥æ›´æ–°

```typescript
// src/services/HolidayUpdateService.ts

import { holidayUpdateManager } from '@/utils/holidays/updateManager';

export class HolidayUpdateService {
  private static CHECK_INTERVAL = 7 * 24 * 60 * 60 * 1000; // 7å¤©
  private static LAST_CHECK_KEY = 'lastHolidayUpdateCheck';
  
  /**
   * å¯åŠ¨æ›´æ–°æ£€æŸ¥ï¼ˆåº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨ï¼‰
   */
  static async start(): Promise<void> {
    // æ£€æŸ¥ä¸Šæ¬¡æ£€æŸ¥æ—¶é—´
    const lastCheck = localStorage.getItem(this.LAST_CHECK_KEY);
    const now = Date.now();
    
    if (lastCheck && now - parseInt(lastCheck) < this.CHECK_INTERVAL) {
      console.log('æœ€è¿‘å·²æ£€æŸ¥è¿‡å‡æ—¥æ›´æ–°ï¼Œè·³è¿‡');
      return;
    }
    
    // åå°æ£€æŸ¥æ›´æ–°
    this.checkAndNotify();
    
    // è®°å½•æ£€æŸ¥æ—¶é—´
    localStorage.setItem(this.LAST_CHECK_KEY, now.toString());
  }
  
  /**
   * æ£€æŸ¥å¹¶é€šçŸ¥ç”¨æˆ·
   */
  private static async checkAndNotify(): Promise<void> {
    const newVersion = await holidayUpdateManager.checkForUpdates();
    
    if (newVersion) {
      this.showUpdateNotification(newVersion);
    }
  }
  
  /**
   * æ˜¾ç¤ºæ›´æ–°é€šçŸ¥ï¼ˆUI å±‚å®ç°ï¼‰
   */
  private static showUpdateNotification(version: HolidayVersion): void {
    // æ–¹å¼ 1: æ¡Œé¢é€šçŸ¥
    if (Notification.permission === 'granted') {
      new Notification('å‡æ—¥æ•°æ®æ›´æ–°', {
        body: `${version.version}å¹´å‡æ—¥å®‰æ’å·²å‘å¸ƒï¼Œç‚¹å‡»æ›´æ–°`,
        icon: '/icon.png'
      });
    }
    
    // æ–¹å¼ 2: åº”ç”¨å†…é€šçŸ¥
    window.dispatchEvent(new CustomEvent('holiday-update-available', {
      detail: version
    }));
  }
  
  /**
   * æ‰‹åŠ¨ä¸‹è½½æ›´æ–°
   */
  static async downloadUpdate(version: HolidayVersion): Promise<boolean> {
    try {
      holidayUpdateManager.installUpdate(version);
      
      // æ˜¾ç¤ºæˆåŠŸæç¤º
      alert(`âœ… ${version.version}å¹´å‡æ—¥æ•°æ®å·²æ›´æ–°`);
      
      return true;
    } catch (error) {
      console.error('æ›´æ–°å¤±è´¥:', error);
      alert('âŒ æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      return false;
    }
  }
}
```

##### 4ï¸âƒ£ UI é€šçŸ¥ç»„ä»¶

```tsx
// src/components/HolidayUpdateBanner.tsx

import React, { useState, useEffect } from 'react';
import { HolidayUpdateService } from '@/services/HolidayUpdateService';

export const HolidayUpdateBanner: React.FC = () => {
  const [updateAvailable, setUpdateAvailable] = useState<HolidayVersion | null>(null);
  const [isUpdating, setIsUpdating] = useState(false);
  
  useEffect(() => {
    const handleUpdate = (e: CustomEvent<HolidayVersion>) => {
      setUpdateAvailable(e.detail);
    };
    
    window.addEventListener('holiday-update-available', handleUpdate as any);
    
    return () => {
      window.removeEventListener('holiday-update-available', handleUpdate as any);
    };
  }, []);
  
  const handleDownload = async () => {
    if (!updateAvailable) return;
    
    setIsUpdating(true);
    const success = await HolidayUpdateService.downloadUpdate(updateAvailable);
    
    if (success) {
      setUpdateAvailable(null);
    }
    setIsUpdating(false);
  };
  
  if (!updateAvailable) return null;
  
  return (
    <div className="holiday-update-banner">
      <div className="banner-content">
        <span className="emoji">ğŸ‰</span>
        <div className="text">
          <strong>{updateAvailable.version}å¹´å‡æ—¥å®‰æ’</strong>
          <span>å·²å‘å¸ƒï¼Œç‚¹å‡»æ›´æ–°</span>
        </div>
      </div>
      
      <div className="banner-actions">
        <button 
          onClick={handleDownload}
          disabled={isUpdating}
          className="btn-primary"
        >
          {isUpdating ? 'æ›´æ–°ä¸­...' : 'ç«‹å³æ›´æ–°'}
        </button>
        
        <button 
          onClick={() => setUpdateAvailable(null)}
          className="btn-text"
        >
          ç¨åæé†’
        </button>
      </div>
    </div>
  );
};
```

```css
/* HolidayUpdateBanner.css */
.holiday-update-banner {
  position: fixed;
  top: 16px;
  right: 16px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 16px 20px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  display: flex;
  align-items: center;
  gap: 16px;
  z-index: 9999;
  animation: slideIn 0.3s ease-out;
}

.banner-content {
  display: flex;
  align-items: center;
  gap: 12px;
}

.emoji {
  font-size: 24px;
}

.text {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.banner-actions {
  display: flex;
  gap: 8px;
}

.btn-primary {
  background: white;
  color: #667eea;
  padding: 8px 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-weight: 600;
}

.btn-text {
  background: transparent;
  color: white;
  padding: 8px 16px;
  border: 1px solid rgba(255,255,255,0.5);
  border-radius: 6px;
  cursor: pointer;
}

@keyframes slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}
```

##### 5ï¸âƒ£ åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–

```typescript
// src/App.tsx

import { HolidayUpdateService } from '@/services/HolidayUpdateService';
import { HolidayUpdateBanner } from '@/components/HolidayUpdateBanner';

function App() {
  useEffect(() => {
    // å¯åŠ¨å‡æ—¥æ›´æ–°æ£€æŸ¥
    HolidayUpdateService.start();
  }, []);
  
  return (
    <div className="App">
      <HolidayUpdateBanner />
      {/* å…¶ä»–ç»„ä»¶ */}
    </div>
  );
}
```

---

### æ–¹æ¡ˆ B: åº”ç”¨å†…è®¾ç½®æ‰‹åŠ¨æ›´æ–°

å¦‚æœä¸æƒ³è‡ªåŠ¨æ£€æŸ¥ï¼Œå¯ä»¥æä¾›æ‰‹åŠ¨æ›´æ–°å…¥å£ï¼š

```tsx
// src/components/Settings/HolidaySettings.tsx

export const HolidaySettings: React.FC = () => {
  const [isChecking, setIsChecking] = useState(false);
  const [updateInfo, setUpdateInfo] = useState<string>('');
  
  const handleCheckUpdate = async () => {
    setIsChecking(true);
    const newVersion = await holidayUpdateManager.checkForUpdates();
    
    if (newVersion) {
      setUpdateInfo(`å‘ç° ${newVersion.version} å¹´å‡æ—¥æ•°æ®`);
    } else {
      setUpdateInfo('å·²æ˜¯æœ€æ–°ç‰ˆæœ¬');
    }
    
    setIsChecking(false);
  };
  
  return (
    <div className="holiday-settings">
      <h3>å‡æ—¥æ•°æ®ç®¡ç†</h3>
      
      <div className="setting-item">
        <label>å½“å‰ç‰ˆæœ¬</label>
        <span>2025, 2026</span>
      </div>
      
      <div className="setting-item">
        <label>æœ€åæ£€æŸ¥æ—¶é—´</label>
        <span>2025-11-11 10:30</span>
      </div>
      
      <button 
        onClick={handleCheckUpdate}
        disabled={isChecking}
        className="btn-check-update"
      >
        {isChecking ? 'æ£€æŸ¥ä¸­...' : 'æ£€æŸ¥æ›´æ–°'}
      </button>
      
      {updateInfo && <p className="update-info">{updateInfo}</p>}
    </div>
  );
};
```

---

### æ–¹æ¡ˆ C: GitHub Actions è‡ªåŠ¨å‘å¸ƒ

åˆ›å»º `.github/workflows/publish-holidays.yml`ï¼š

```yaml
name: Publish Holiday Data

on:
  push:
    tags:
      - 'holidays-*'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      
      - name: Extract version
        id: version
        run: echo "YEAR=${GITHUB_REF#refs/tags/holidays-}" >> $GITHUB_OUTPUT
      
      - name: Build holiday JSON
        run: |
          node scripts/buildHolidayData.js ${{ steps.version.outputs.YEAR }}
      
      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          files: |
            public/holidays/holidays-${{ steps.version.outputs.YEAR }}.json
          body: |
            ## ${{ steps.version.outputs.YEAR }}å¹´å‡æ—¥å®‰æ’
            
            æ ¹æ®å›½åŠ¡é™¢åŠå…¬å…é€šçŸ¥å‘å¸ƒ
            
            **åŒ…å«å†…å®¹**:
            - æ³•å®šèŠ‚å‡æ—¥å®‰æ’
            - è°ƒä¼‘å·¥ä½œæ—¥
            - å‡æœŸå¤©æ•°ç»Ÿè®¡
          tag_name: holidays-${{ steps.version.outputs.YEAR }}
```

**ä½¿ç”¨æµç¨‹**ï¼š
1. å›½åŠ¡é™¢å‘å¸ƒå‡æ—¥å®‰æ’
2. å¼€å‘è€…æ›´æ–° `adjustedWorkdays.ts`
3. è¿è¡Œ `git tag holidays-2026 && git push --tags`
4. GitHub Actions è‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒ Release
5. ç”¨æˆ·åº”ç”¨è‡ªåŠ¨æ£€æŸ¥åˆ°æ›´æ–°

---

### ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ç”¨æˆ·ä½“éªŒ | å¼€å‘æˆæœ¬ | ç»´æŠ¤æˆæœ¬ |
|------|---------|---------|---------|
| **A. GitHub è‡ªåŠ¨æ›´æ–°** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| **B. æ‰‹åŠ¨æ›´æ–°** | â­â­â­ | â­â­ | â­â­â­ |
| **C. åº”ç”¨æ›´æ–°æ†ç»‘** | â­â­â­â­ | â­ | â­â­ |

**æ¨è**: æ–¹æ¡ˆ Aï¼ˆGitHub è‡ªåŠ¨æ›´æ–°ï¼‰

---

## ğŸ”§ ç»´æŠ¤æŒ‡å—ï¼ˆç®€åŒ–ç‰ˆï¼‰

### æ¯å¹´ç»´æŠ¤ä»»åŠ¡ï¼ˆçº¦10åˆ†é’Ÿï¼‰

**æ—¶é—´**: æ¯å¹´12æœˆï¼Œå›½åŠ¡é™¢å‘å¸ƒä¸‹ä¸€å¹´åº¦å‡æ—¥å®‰æ’å

**æ­¥éª¤**:
1. è®¿é—®å›½åŠ¡é™¢å®˜ç½‘è·å–å‡æ—¥å®‰æ’
2. æ›´æ–° `src/utils/holidays/adjustedWorkdays.ts`
3. è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ•°æ®
4. åˆ›å»º Git tag: `git tag holidays-2026`
5. æ¨é€åˆ° GitHub: `git push --tags`
6. GitHub Actions è‡ªåŠ¨å‘å¸ƒ
7. ç”¨æˆ·è‡ªåŠ¨æ”¶åˆ°æ›´æ–°é€šçŸ¥

**æ— éœ€åšçš„**:
- âŒ æ‰‹åŠ¨æ„å»ºåº”ç”¨
- âŒ åˆ†å‘æ›´æ–°åŒ…
- âŒ é€šçŸ¥ç”¨æˆ·

---
  ]
};
```

### å†œå†èŠ‚æ—¥ï¼ˆæ— éœ€ç»´æŠ¤ï¼‰

`lunar-javascript` åº“è‡ªåŠ¨è®¡ç®—ï¼Œæ°¸ä¹…æœ‰æ•ˆã€‚

### å›ºå®šèŠ‚æ—¥ï¼ˆä¸€æ¬¡é…ç½®ï¼‰

åˆå§‹è®¾ç½®åæ— éœ€ç»´æŠ¤ï¼Œé™¤éï¼š
- å›½å®¶æ–°å¢æ³•å®šèŠ‚å‡æ—¥
- ç”¨æˆ·åé¦ˆéœ€è¦æ·»åŠ æ–°çš„å›½é™…èŠ‚æ—¥

---

## ğŸ‰ æ€»ç»“

### ä¼˜åŠ¿

âœ… **ç¦»çº¿å¯ç”¨** - æ— éœ€ç½‘ç»œï¼Œéšæ—¶å¯ç”¨  
âœ… **é›¶æˆæœ¬** - æ— éœ€è´­ä¹° API æœåŠ¡  
âœ… **é«˜æ€§èƒ½** - æœ¬åœ°è®¡ç®—ï¼Œå³æ—¶å“åº”  
âœ… **å¯æ§æ€§å¼º** - æ•°æ®å®Œå…¨è‡ªä¸»ç®¡ç†  
âœ… **å†œå†æ”¯æŒ** - lunar-javascript å¼ºå¤§å¯é   

### ç»´æŠ¤æˆæœ¬

âš ï¸ æ¯å¹´12æœˆæ›´æ–°è°ƒä¼‘æ•°æ®ï¼ˆ**çº¦5åˆ†é’Ÿ**ï¼‰

### æ‰©å±•æ€§

ğŸ”® æœªæ¥å¯æ”¯æŒï¼š
- è‡ªå®šä¹‰èŠ‚æ—¥ï¼ˆç”Ÿæ—¥ã€çºªå¿µæ—¥ï¼‰
- å¤šå›½èŠ‚æ—¥åˆ‡æ¢
- èŠ‚æ—¥æé†’åŠŸèƒ½
- èŠ‚æ—¥å€’è®¡æ—¶

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [lunar-javascript GitHub](https://github.com/6tail/lunar-javascript)
- [å›½åŠ¡é™¢åŠå…¬å…èŠ‚å‡æ—¥å®‰æ’é€šçŸ¥](http://www.gov.cn/)
- å®Œæ•´è®¾è®¡æ–‡æ¡£: `docs/PRD/TIME_PICKER_AND_DISPLAY_PRD.md` Â§ 0.9

---

**æœ€åæ›´æ–°**: 2025-11-11  
**è®¾è®¡ç‰ˆæœ¬**: v2.1  
**å®ç°çŠ¶æ€**: å¾…å¼€å‘
