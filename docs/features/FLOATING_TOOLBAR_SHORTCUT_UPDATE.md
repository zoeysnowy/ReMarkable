# FloatingToolbar 快捷键更新

## 📋 修改概述

将 FloatingToolbar 的快捷键从 `Ctrl+/` 改为 `Alt+1-5`，并添加了编辑状态检查，确保快捷键只在编辑器内激活时生效。

## 🔑 新快捷键映射

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Alt+1` | 标签 (Tag) | 打开标签选择器 |
| `Alt+2` | 表情 (Emoji) | 打开表情选择器 |
| `Alt+3` | 日期 (Date) | 打开日期时间选择器 |
| `Alt+4` | 优先级 (Priority) | 打开优先级选择器 |
| `Alt+5` | 颜色 (Color) | 打开颜色选择器 |

## ✅ 核心改进

### 1. 快捷键数量扩展
- **旧版本**: 单一快捷键 `Ctrl+/` 只能切换工具栏显示
- **新版本**: 5 个独立快捷键，每个对应一个具体功能

### 2. 编辑状态检查
```typescript
// 检查是否在编辑器区域内
const target = event.target as HTMLElement;
const isInEditor = editorRef.current?.contains(target);

// 只有在编辑器内（编辑状态激活时）才响应快捷键
if (!isInEditor) return;
```

**优点**：
- ✅ 避免在非编辑区域误触发
- ✅ 只在用户真正编辑内容时响应
- ✅ 更符合用户的操作预期

### 3. 减少快捷键冲突
- `Alt+数字` 组合在大多数应用中冲突较少
- 避免与浏览器/系统常用快捷键冲突

## 📁 修改文件列表

1. **`src/hooks/useFloatingToolbar.ts`**
   - 修改 `handleKeyDown` 函数
   - 添加编辑器焦点检查
   - 更新快捷键解析逻辑（Alt+1-5）
   - 更新注释和默认参数

2. **`docs/FLOATING_TOOLBAR_GUIDE.md`**
   - 更新快捷键列表
   - 添加编辑状态说明
   - 更新 FAQ 部分

3. **`CHANGELOG.md`**
   - 添加本次更新记录

## 🧪 测试建议

### 测试场景 1: 编辑器内
1. 点击 PlanManager 中的任意计划项，进入编辑状态
2. 按下 `Alt+1` 到 `Alt+5`
3. **预期**: 相应的功能选择器弹出

### 测试场景 2: 编辑器外
1. 点击编辑器外的任意区域（如侧边栏、标题栏）
2. 按下 `Alt+1` 到 `Alt+5`
3. **预期**: 快捷键不响应，工具栏不弹出

### 测试场景 3: 快捷键切换
1. 在编辑状态下按 `Alt+1` 打开标签选择器
2. 再次按 `Alt+1`
3. **预期**: 工具栏关闭

## 💡 使用提示

1. **快速插入标签**: 编辑时按 `Alt+1`，选择标签
2. **快速添加日期**: 编辑时按 `Alt+3`，选择时间范围
3. **设置优先级**: 编辑时按 `Alt+4`，选择优先级

## 🔮 未来优化建议

1. **可配置快捷键**: 允许用户在设置中自定义快捷键
2. **快捷键提示**: 在工具栏上显示对应的快捷键提示
3. **按钮数量适配**: 当工具栏功能按钮超过 5 个时，动态调整快捷键映射

## 📌 注意事项

- Alt 键在某些操作系统（如 Linux）中可能会激活菜单栏，建议测试后使用
- 如需修改快捷键，可以直接修改 `useFloatingToolbar.ts` 中的判断逻辑
- 编辑器内的 `contentEditable` 元素需要正确设置，才能触发焦点检查

---

**修改日期**: 2025-10-30  
**修改人**: GitHub Copilot  
**相关 Issue**: N/A
